<div class="public-request-page">
    <div class="public-request-container">
        <!-- Header -->
        <div class="pr-header">
            <div class="pr-logo">
                <i class="bi bi-droplet-fill"></i>
            </div>
            <h1>Request Blood</h1>
            <p>Submit a blood request to our blood bank. No account required.</p>
        </div>

        @if (submitted) {
        <!-- Success State -->
        <div class="success-card">
            <div class="success-icon"><i class="bi bi-check-circle-fill"></i></div>
            <h2>Request Submitted!</h2>
            <p>{{ successMessage }}</p>
            <p class="success-note">Our team will review your request shortly. You will be contacted on the phone number
                provided.</p>
            <button class="btn-primary-custom" (click)="resetForm()">
                <i class="bi bi-plus-lg"></i> Submit Another Request
            </button>
        </div>
        } @else {
        <!-- Form -->
        <form (ngSubmit)="submit()" class="pr-form">
            @if (error) {
            <div class="alert-danger">
                <i class="bi bi-exclamation-triangle-fill"></i> {{ error }}
            </div>
            }

            <div class="form-group">
                <label><i class="bi bi-person-fill"></i> Full Name *</label>
                <input type="text" [(ngModel)]="form.name" name="name" class="form-input"
                    placeholder="Enter your full name" required>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label><i class="bi bi-gender-ambiguous"></i> Gender *</label>
                    <select [(ngModel)]="form.gender" name="gender" class="form-input">
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label><i class="bi bi-telephone-fill"></i> Contact *</label>
                    <input type="tel" [(ngModel)]="form.contact" name="contact" class="form-input"
                        placeholder="10-digit number" required pattern="[0-9]{10}">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label><i class="bi bi-droplet-half"></i> Blood Group *</label>
                    <select [(ngModel)]="form.bloodGroup" name="bloodGroup" class="form-input">
                        @for (bg of bloodGroups; track bg) {
                        <option [value]="bg">{{ bg }}</option>
                        }
                    </select>
                </div>
                <div class="form-group">
                    <label><i class="bi bi-capsule"></i> Component</label>
                    <select [(ngModel)]="form.component" name="component" class="form-input">
                        @for (c of components; track c) {
                        <option [value]="c">{{ c }}</option>
                        }
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label><i class="bi bi-exclamation-diamond-fill"></i> Urgency</label>
                    <select [(ngModel)]="form.urgencyLevel" name="urgencyLevel" class="form-input">
                        <option value="Normal">Normal</option>
                        <option value="Urgent">Urgent</option>
                        <option value="Critical">Critical</option>
                    </select>
                </div>
                <div class="form-group">
                    <label><i class="bi bi-hash"></i> Units</label>
                    <input type="number" [(ngModel)]="form.units" name="units" class="form-input" min="1" max="10">
                </div>
            </div>

            <div class="form-group">
                <label><i class="bi bi-hospital-fill"></i> Hospital Name</label>
                <input type="text" [(ngModel)]="form.hospitalName" name="hospitalName" class="form-input"
                    placeholder="Hospital where blood is needed">
            </div>

            <button type="submit" class="btn-submit" [disabled]="submitting || !form.name || !form.contact">
                @if (submitting) {
                <span class="spinner-sm"></span> Submitting...
                } @else {
                <i class="bi bi-send-fill"></i> Submit Request
                }
            </button>
        </form>
        }

        <div class="pr-footer">
            <a routerLink="/login"><i class="bi bi-box-arrow-in-right"></i> Staff Login</a>
        </div>
    </div>
</div>